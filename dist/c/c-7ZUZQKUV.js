import{a as t}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-FXIE2AIM.js";import{a as o,b as p,c as r,d as w}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-7CFXYJFX.js";import{a as h}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-HCZWXC2L.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-BRM3VK4K.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-YUKWNWI4.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-454JAFTG.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-R4GW7XKD.js";import{a as e,b as u}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-2OJY4IO5.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-AR72JQIL.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-AWP2XIAB.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-GNV6ZOFK.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-TGRK7PLA.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-CDYBUNWF.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-ENEBB2BD.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-5QWV5VGN.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-TTFLGKY7.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-DUYVVWC2.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-YPKJ5RBM.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-DPMJD53A.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-ZNUHMR4K.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-BUXQR4ES.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-LUPZ4KHN.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-BEHZ7JTS.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-YSUIEIGX.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-HZFHMHQN.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-G4ZGUIOQ.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-DP5S7JQD.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-4XE6PYTU.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-6SAQQLAB.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-CX3UHCB7.js";import{a as g}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-3OYBSJ6E.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-24SS665B.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-6R2BGVIA.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-PK5BQFNF.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-JLXBJ3P2.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-EWMA2A3Y.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-YZIFUDII.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-SZDEYI6M.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-J6CY7UZJ.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-VAC7F2QX.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-5PAPEHFG.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-SGCAKXE6.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-NHBDAKNJ.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-K2A5B6JM.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-N6EHSBD5.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-WI7A4VZE.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-OGX4AJWG.js";import{a as c}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-2UHVXKP7.js";import{b as a}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-5IMPP7QC.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-CT6M5GAC.js";import"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-ZOIQ6RG5.js";import{d as i}from"https://st-p.rmcdn1.net/8a678eb9/dist/c/c-DPLWGYAY.js";var n=i(c()),s=i(a()),l=i(g());p();u();w();var m=t.extend({render:function(){return this.rendered=!0,this.template=h["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&this.selectedType==="picture"?this.renderPicture():!s.default.isEmpty(this.video)&&this.selectedType==="video"?this.renderVideo():this.slideshow&&this.selectedType==="slideshow"?this.renderSlideshow():this.widgetIsLoaded(),this},start:function(){return this.started=!0,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.start(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&!this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.selectedType==="video"&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),this.selectedType==="slideshow"&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),t.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!!(!RM.screenshot&&this.selectedType==="video"&&this.video&&this.video.url)},renderPicture:function(){if(!this.picture){this.widgetIsLoaded();return}let d=e.useLambdaUrl(this.picture)||e.useLambdaUrlOldProjects(this.picture,"background")?e.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;(0,n.default)("<img/>").on("load",s.default.bind(function(){this.$picture.css({"background-image":"url("+d+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()},this)).on("error",this.widgetIsLoaded).attr("src",d)},renderSlideshow:function(){this.slideshowWidget=new o({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.videoWidget=new r({el:this.$videoContainer.get(0),model:new l.default.Model({video:this.video}),attributes:{thumbnailMode:window.RM.screenshot}}),this.videoWidget.on("loaded",()=>{this.widgetIsLoaded()}),this.videoWidget.on("playStarted",()=>{this.trigger("videoBGStarted")}),this.videoWidget.render()}}),b=m;export{b as default};
